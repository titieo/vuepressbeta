"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolvePageComponentInfo = void 0;
const utils_1 = require("@vuepress/utils");
/**
 * Resolve page component and related info
 */
const resolvePageComponentInfo = async ({ app, content, frontmatter, filePath, filePathRelative, htmlFilePathRelative, key, }) => {
    const markdownEnv = {
        base: app.options.base,
        filePath,
        filePathRelative,
        frontmatter,
    };
    const rendered = app.markdown.render(content, markdownEnv);
    /* istanbul ignore next */
    const { headers = [], hoistedTags = [], importedFiles = [], links = [], } = markdownEnv;
    // resolve component file content
    // take the rendered markdown content as <template>
    // hoist `<script>`, `<style>` and other custom blocks
    const componentFileContent = [
        `<template>${rendered}</template>`,
        ...hoistedTags,
    ].join('\n\n');
    // resolve component file path
    const componentFilePathRelative = utils_1.path.join('pages', `${htmlFilePathRelative}.vue`);
    const componentFilePath = app.dir.temp(componentFilePathRelative);
    const componentFileChunkName = key;
    return {
        deps: importedFiles,
        headers,
        links,
        componentFilePath,
        componentFilePathRelative,
        componentFileContent,
        componentFileChunkName,
    };
};
exports.resolvePageComponentInfo = resolvePageComponentInfo;
